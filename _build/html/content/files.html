
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8. Files &#8212; NWI-BM066A Computation for Biologists</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9. Scripts" href="scripts.html" />
    <link rel="prev" title="7. Assembling the pieces" href="extra_exercises.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">NWI-BM066A Computation for Biologists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="01_introduction.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="first_exercises.html">
   1. First exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lists.html">
   2. Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="control_flow.html">
   3. Control flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="loops.html">
   4. Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions_modules.html">
   5. Functions and modules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   6. Dictionaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="extra_exercises.html">
   7. Assembling the pieces
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   8. Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scripts.html">
   9. Scripts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="debugging.html">
   10. Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pandas.html">
   11. Introduction to pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visualization.html">
   12. Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dnase_motifs.html">
   13. Motifs in DNase I peaks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="footprints.html">
   14. Creating a DNAseI footprint profile
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/vanheeringen-lab/cfb_book/master?urlpath=tree/content/files.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/vanheeringen-lab/cfb_book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/vanheeringen-lab/cfb_book/issues/new?title=Issue%20on%20page%20%2Fcontent/files.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/vanheeringen-lab/cfb_book/edit/master/content/files.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/content/files.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-files">
   8.1. Introduction to files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#glossary-of-file-terms-and-functions">
   8.2. Glossary of file terms and functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises-files">
   8.3. Exercises: files
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Files</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-files">
   8.1. Introduction to files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#glossary-of-file-terms-and-functions">
   8.2. Glossary of file terms and functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises-files">
   8.3. Exercises: files
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="files">
<h1><span class="section-number">8. </span>Files<a class="headerlink" href="#files" title="Permalink to this headline">#</a></h1>
<section id="introduction-to-files">
<h2><span class="section-number">8.1. </span>Introduction to files<a class="headerlink" href="#introduction-to-files" title="Permalink to this headline">#</a></h2>
<p>Thus far we have used Python without reading input from files and writing output to files. We have created objects like lists and dictionaries, but nothing has been saved persistently, meaning that if we close Python, everything is gone. Usually you want to open a file, read its contents (line by line), analyze it, and write it to another file. To work with files we need the Python <code class="docutils literal notranslate"><span class="pre">file</span></code> object. <code class="docutils literal notranslate"><span class="pre">file</span></code> objects serve as a <em>link to a file</em> residing on a disk or cloud.</p>
<p>To open a file, write some contents to it and close it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;testfile.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">myfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;some text</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Note the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">myfile</span></code> is the name of the Python <code class="docutils literal notranslate"><span class="pre">file</span></code> <em>object</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'testfile.txt'</span></code> is the name of the <em>file</em> written to the disk or the cloud</p>
<ul>
<li><p>extension is not important, but suggests that it contains text</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">'w'</span></code> argument to the <code class="docutils literal notranslate"><span class="pre">open()</span></code> function opens the file for <em>writing</em></p></li>
<li><p>If the file <code class="docutils literal notranslate"><span class="pre">'testfile.txt'</span></code> already exists, you will overwrite its contents</p></li>
<li><p>If not, the file <code class="docutils literal notranslate"><span class="pre">'testfile.txt'</span></code> will be created</p></li>
<li><p>You can also use <code class="docutils literal notranslate"><span class="pre">'a'</span></code> instead, which would <em>append</em> any output to the existing file called <code class="docutils literal notranslate"><span class="pre">'testfile.txt'</span></code></p></li>
<li><p>If you use <code class="docutils literal notranslate"><span class="pre">'r'</span></code> instead, you only open the file for only <em>reading</em> (it has to exist of course)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write()</span></code> is a method belonging to the <code class="docutils literal notranslate"><span class="pre">file</span></code> object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write()</span></code> does not add a newline character to the end of a line, that is why we add <code class="docutils literal notranslate"><span class="pre">\n</span></code> to our text</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">close()</span></code> is a method belonging to the <code class="docutils literal notranslate"><span class="pre">file</span></code> object</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">'testfile.txt'</span></code> is written to your Google Colab <code class="docutils literal notranslate"><span class="pre">/content</span></code> folder, and will be visible in the file-explorer pane once you refresh it. However, your Google Colab <code class="docutils literal notranslate"><span class="pre">/content</span></code> folder is temporary and will be cleared after a few hours.</p>
</div>
<p>To save the file permanently, you can write it to Google Drive:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/gdrive&#39;</span><span class="p">)</span>

<span class="c1"># choose the Google account that you want to use, and allow access</span>

<span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/testfile_gdrive.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">myfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;this file is saved in Google Drive </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>To work with an existing file, we could open it and work on the complete contents in the file. However, sometimes the files used for our analyses are very large. If the file contains lines of text, we may rather open the file, process its contents <em>line-by-line</em>, and write output to another file.</p>
<p>To open a file and read its contents line-by-line we first open the file using <code class="docutils literal notranslate"><span class="pre">open()</span></code>. To step through the file line-by-line we use a <code class="docutils literal notranslate"><span class="pre">for</span></code> or <code class="docutils literal notranslate"><span class="pre">while</span></code> loop to ‘iterate’ over the resulting <code class="docutils literal notranslate"><span class="pre">file</span></code> object. <em>Each iteration returns a line of the file, from top to bottom</em>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">for</span></code> or <code class="docutils literal notranslate"><span class="pre">while</span></code> loop automatically ends as soon as there are no lines anymore (=after the last line).</p>
<p>At the end of the code that you execute for each line, you should close the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [2],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;
</pre></div>
</div>
</div>
</div>
<p>The file <code class="docutils literal notranslate"><span class="pre">/content/gdrive/MyDrive/CFB_2022/example.bed</span></code> is an example BED file. BED files are used to store genomic coordinates along with additional information. BED files are for instance used to store genomic coordinates of ChIP-seq peaks. The first three fields (columns) contain the chromosome, start, and end of the features, respectively. The file <code class="docutils literal notranslate"><span class="pre">/content/gdrive/MyDrive/CFB_2022/example.bed</span></code> also contains ‘header’ lines that are used when the file is displayed in the UCSC genome browser. This is not always the case for BED files.</p>
<p>While the code above functions just fine, it is nowadays more common in Python to open files with the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>browser position chr7:127471196-127495720

browser hide all

track name=&quot;example&quot; description=&quot;example_bed_file&quot; visibility=2 itemRgb=&quot;On&quot;

chr7	127471196	127472363	Pos1	0	+	127471196	127472363	255,0,0

chr7	127472363	127473530	Pos2	0	+	127472363	127473530	255,0,0

chr7	127473530	127474697	Pos3	0	+	127473530	127474697	255,0,0

chr7	127474697	127475864	Pos4	0	+	127474697	127475864	255,0,0

chr7	127475864	127477031	Neg1	0	-	127475864	127477031	0,0,255

chr7	127477031	127478198	Neg2	0	-	127477031	127478198	0,0,255

chr7	127478198	127479365	Neg3	0	-	127478198	127479365	0,0,255

chr7	127479365	127480532	Pos5	0	+	127479365	127480532	255,0,0

chr7	127480532	127481699	Neg4	0	-	127480532	127481699	0,0,255
</pre></div>
</div>
</div>
</div>
<p>You see that the code is very similar. However, you don’t have to explicitly close the file. As soon as the code exits the <code class="docutils literal notranslate"><span class="pre">with</span></code> block, the file is closed automatically.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">with</span></code> statement is the preferred way to work with files.</p>
</div>
<p>In the next few examples we will see some analysis of this file in action. Each example adds some steps and builds from the previous example.</p>
<p>Example 1:</p>
<ul class="simple">
<li><p>open the <code class="docutils literal notranslate"><span class="pre">/content/gdrive/MyDrive/CFB_2022/example.bed</span></code> file</p></li>
<li><p>read the file line-by-line</p></li>
<li><p>ignore header lines starting with ‘browser’ or ‘track’</p></li>
<li><p>split each line into a list based on the <code class="docutils literal notranslate"><span class="pre">&lt;tab&gt;</span></code> character</p></li>
<li><p>print each line</p></li>
<li><p>print the values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>        <span class="c1"># use a variable called &#39;line&#39; for each line</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>    <span class="c1"># take away the &#39;\\n&#39; character at the end of each line</span>
        <span class="c1"># only proceed with lines lacking &#39;browser&#39; or &#39;track&#39; at the beginning</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;browser&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;track&#39;</span><span class="p">):</span>
            <span class="c1"># split the line (`string`) into a `list`, with the &#39;\\t&#39; as a delimiter</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;chr7&#39;, &#39;127471196&#39;, &#39;127472363&#39;, &#39;Pos1&#39;, &#39;0&#39;, &#39;+&#39;, &#39;127471196&#39;, &#39;127472363&#39;, &#39;255,0,0&#39;]
[&#39;chr7&#39;, &#39;127472363&#39;, &#39;127473530&#39;, &#39;Pos2&#39;, &#39;0&#39;, &#39;+&#39;, &#39;127472363&#39;, &#39;127473530&#39;, &#39;255,0,0&#39;]
[&#39;chr7&#39;, &#39;127473530&#39;, &#39;127474697&#39;, &#39;Pos3&#39;, &#39;0&#39;, &#39;+&#39;, &#39;127473530&#39;, &#39;127474697&#39;, &#39;255,0,0&#39;]
[&#39;chr7&#39;, &#39;127474697&#39;, &#39;127475864&#39;, &#39;Pos4&#39;, &#39;0&#39;, &#39;+&#39;, &#39;127474697&#39;, &#39;127475864&#39;, &#39;255,0,0&#39;]
[&#39;chr7&#39;, &#39;127475864&#39;, &#39;127477031&#39;, &#39;Neg1&#39;, &#39;0&#39;, &#39;-&#39;, &#39;127475864&#39;, &#39;127477031&#39;, &#39;0,0,255&#39;]
[&#39;chr7&#39;, &#39;127477031&#39;, &#39;127478198&#39;, &#39;Neg2&#39;, &#39;0&#39;, &#39;-&#39;, &#39;127477031&#39;, &#39;127478198&#39;, &#39;0,0,255&#39;]
[&#39;chr7&#39;, &#39;127478198&#39;, &#39;127479365&#39;, &#39;Neg3&#39;, &#39;0&#39;, &#39;-&#39;, &#39;127478198&#39;, &#39;127479365&#39;, &#39;0,0,255&#39;]
[&#39;chr7&#39;, &#39;127479365&#39;, &#39;127480532&#39;, &#39;Pos5&#39;, &#39;0&#39;, &#39;+&#39;, &#39;127479365&#39;, &#39;127480532&#39;, &#39;255,0,0&#39;]
[&#39;chr7&#39;, &#39;127480532&#39;, &#39;127481699&#39;, &#39;Neg4&#39;, &#39;0&#39;, &#39;-&#39;, &#39;127480532&#39;, &#39;127481699&#39;, &#39;0,0,255&#39;]
</pre></div>
</div>
</div>
</div>
<p>Note how we used <code class="docutils literal notranslate"><span class="pre">startswith()</span></code> to check if a string starts with ‘browser’ or ‘track’</p>
<p>Example 2:</p>
<ul class="simple">
<li><p>assign the first three elements of this list to the variables <code class="docutils literal notranslate"><span class="pre">chrom</span></code>, <code class="docutils literal notranslate"><span class="pre">start</span></code>, and <code class="docutils literal notranslate"><span class="pre">end</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;browser&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;track&#39;</span><span class="p">):</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  
            <span class="nb">print</span><span class="p">(</span><span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>chr7 127471196 127472363
chr7 127472363 127473530
chr7 127473530 127474697
chr7 127474697 127475864
chr7 127475864 127477031
chr7 127477031 127478198
chr7 127478198 127479365
chr7 127479365 127480532
chr7 127480532 127481699
</pre></div>
</div>
</div>
</div>
<p>Example 3:</p>
<ul class="simple">
<li><p>convert the <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> variables to an integer <code class="docutils literal notranslate"><span class="pre">int</span></code> (they are strings at first)</p></li>
<li><p>calculate the width (size in bases) of each feature</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>              
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>          
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;browser&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;track&#39;</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>  
            <span class="n">chrom</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>      
            <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>    <span class="c1"># convert start to `int`</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>        <span class="c1"># convert end to `int`</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1167
1167
1167
1167
1167
1167
1167
1167
1167
</pre></div>
</div>
</div>
</div>
<p>Example 4:</p>
<ul class="simple">
<li><p>calculate how many features with strand ‘+’ and strand ‘-’ are present</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plus</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">minus</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/MyDrive/CFB_2022/example.bed&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;browser&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;track&#39;</span><span class="p">):</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">strand</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="n">plus</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">strand</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="n">minus</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">plus</span><span class="p">,</span> <span class="n">minus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 4
</pre></div>
</div>
</div>
</div>
<p>Thus far we have used the <code class="docutils literal notranslate"><span class="pre">print()</span></code> statement to print output to the screen. But if you want to be more explicit in the formatting of the output, you should use <code class="docutils literal notranslate"><span class="pre">format()</span></code>, which creates a <code class="docutils literal notranslate"><span class="pre">string</span></code> that can either be printed or written to a file. The standard way of using <code class="docutils literal notranslate"><span class="pre">format()</span></code> is like this: <code class="docutils literal notranslate"><span class="pre">'some</span> <span class="pre">text</span> <span class="pre">{}</span> <span class="pre">more</span> <span class="pre">text</span> <span class="pre">{}'.format(var1,</span> <span class="pre">var2)</span></code>. See the following example in which <code class="docutils literal notranslate"><span class="pre">format()</span></code> is used:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HCT116&#39;</span><span class="p">,</span> <span class="s1">&#39;HeLa&#39;</span><span class="p">,</span> <span class="s1">&#39;HEK293&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;Cell line </span><span class="si">{}</span><span class="s1"> is </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cell_lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell line 1 is HCT116
Cell line 2 is HeLa
Cell line 3 is HEK293
</pre></div>
</div>
</div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">print()</span></code> statement by default adds a newline character <code class="docutils literal notranslate"><span class="pre">&quot;\n&quot;</span></code>. If you write to a file you need to add the newline character <code class="docutils literal notranslate"><span class="pre">&quot;\n&quot;</span></code> to the string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cell_lines.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">cell_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HCT116&#39;</span><span class="p">,</span> <span class="s1">&#39;HeLa&#39;</span><span class="p">,</span> <span class="s1">&#39;HEK293&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;Cell line </span><span class="si">{}</span><span class="s1"> is</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cell_lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note how we also used <code class="docutils literal notranslate"><span class="pre">&quot;\t&quot;</span></code> here. This is the character that specifies a <code class="docutils literal notranslate"><span class="pre">&lt;tab&gt;</span></code>.</p>
</section>
<section id="glossary-of-file-terms-and-functions">
<h2><span class="section-number">8.2. </span>Glossary of file terms and functions<a class="headerlink" href="#glossary-of-file-terms-and-functions" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">open()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">with</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">while</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">startswith()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">format()</span></code></p></li>
</ul>
</section>
<section id="exercises-files">
<h2><span class="section-number">8.3. </span>Exercises: files<a class="headerlink" href="#exercises-files" title="Permalink to this headline">#</a></h2>
<p><strong>Exercise 8.1</strong></p>
<p>In this exercise you are going to analyze data from ChIP-seq of several transcription factors in mouse embryonic stem cells (<a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/18555785/">Chen et al. 2008, 13;133(6):1106-17, PMID 18555785</a>). Please have a look at Figure 1 and 2 of this paper. Figure 1 shows the ChIP-seq profiles for the transcription factors.</p>
<p>The ChIP-seq peaks that you see represent <em>in vivo</em> binding sites of these transcription factors. In Figure 2 the authors have analyzed the DNA sequence underneath these peaks, and identified specific DNA sequences (<strong>motifs</strong>) for each transcription factor.</p>
<p>You are going to analyze these sequences as well, to see which motifs you can identify. You will count <strong>k-mers</strong> (short sequences, e.g. 8 bases in length) in the sequences underneath the ChIP-seq peaks of a specific transcription factor, and analyze which k-mers are overrepresented.</p>
<p>DNA (or amino acid) sequence files are usually in FASTA format. Check out <a class="reference external" href="https://en.wikipedia.org/wiki/FASTA_format">https://en.wikipedia.org/wiki/FASTA_format</a> for a FASTA description and an example. Just read the first part.</p>
<p>Before you start off using the FASTA files from the study mentioned above, you will work on a file called <code class="docutils literal notranslate"><span class="pre">testfile.fasta</span></code> (present in <code class="docutils literal notranslate"><span class="pre">/content/gdrive/MyDrive/CFB_2022</span></code>), which is a small FASTA file. This allows you to make and test your code quicker.</p>
<ol class="simple">
<li><p>Provide the Python code that allows you to read the FASTA file while ignoring the description lines containing <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>. For now it is OK to print the output.</p></li>
<li><p>Extend your code with the following: For each sequence, extract all possible k-mers of length 4. Skip sequences that are shorter than 4 bases. Print the output. Make sure your code allows you to easily run the same analysis with different k-mer lengths.</p></li>
<li><p>Extend your code with the following: Count the number of occurrences for each k-mer that is encountered (in all sequences together).</p></li>
<li><p>Extend your code with the following: Write the top 10 most abundant k-mer sequences to an output file, along with the number of times they occur.</p></li>
<li><p>Now that you have assembled your code (you can remove the printing statements you used for testing) adapt your code to count kmers of <strong>length 8</strong>. Run your code on 2 files present in the <code class="docutils literal notranslate"><span class="pre">/content/gdrive/MyDrive/CFB_2022</span></code> directory:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GSM288346_ES_Oct4_mm9.peaks.fasta</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GSM288356_ES_c-Myc_mm9.peaks.fasta</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GSM288353_ES_Stat3_mm9.peaks.fasta</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GSM288354_ES_Klf4_mm9.peaks.fasta</span></code></p></li>
</ul>
<p>For the top most occurring 8-mers that you obtained for each file, do these resemble the motifs for the corresponding transcription factors as displayed in Figure 2 of the paper?</p>
<ol class="simple">
<li><p>Write a function called <code class="docutils literal notranslate"><span class="pre">top_kmers()</span></code>. The function should have three arguments: <code class="docutils literal notranslate"><span class="pre">fname</span></code>, <code class="docutils literal notranslate"><span class="pre">k</span></code>, <code class="docutils literal notranslate"><span class="pre">n_top</span></code>. The <code class="docutils literal notranslate"><span class="pre">fname</span></code> represents the FASTA filename, <code class="docutils literal notranslate"><span class="pre">k</span></code> the length of the k-mer and <code class="docutils literal notranslate"><span class="pre">n_top</span></code> the number of most abundant k-mers to return. The function should not print the k-mers, but return them as a list. The <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">n_top</span></code> arguments should be <em>optional</em>, with default values of 8 and 10, respectively.</p></li>
</ol>
<p><strong>Exercise 8.2: FASTA files</strong></p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/FASTA_format">FASTA format</a> is a widely used text format to represent nucleotide or peptide sequences.
Write a function <code class="docutils literal notranslate"><span class="pre">read_fasta</span></code> that reads a multiple sequence FASTA file.
The function should take the file name as an argument and return a dictionary
with the sequence identifier as key and the actual sequence as value. Note that the <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> symbol is not part of the sequence identifier.
Create files for all your test cases.
You can create text files from the jupyter window (<code class="docutils literal notranslate"><span class="pre">New</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Text</span> <span class="pre">File</span></code>) or use the <code class="docutils literal notranslate"><span class="pre">Upload</span></code> button to upload files you created locally.</p>
<p><strong>Exercise 8.3: convert gene annotation file</strong></p>
<p>The file <code class="docutils literal notranslate"><span class="pre">/content/gdrive/MyDrive/CFB_2022/genes.txt</span></code> contains gene annotation. Each line represents one gene. The file is
tab-separated and contains the following columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">chromosome</span>
<span class="mi">2</span> <span class="o">-</span> <span class="n">gene</span> <span class="n">start</span>
<span class="mi">3</span> <span class="o">-</span> <span class="n">gene</span> <span class="n">end</span>
<span class="mi">4</span> <span class="o">-</span> <span class="n">strand</span>
<span class="mi">5</span> <span class="o">-</span> <span class="n">gene</span> <span class="n">name</span>
<span class="mi">6</span> <span class="o">-</span> <span class="n">number</span> <span class="n">of</span> <span class="n">exons</span>
<span class="mi">7</span> <span class="o">-</span> <span class="n">a</span> <span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">exon</span> <span class="n">sizes</span>
<span class="mi">8</span> <span class="o">-</span> <span class="n">a</span> <span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">exon</span> <span class="n">starts</span><span class="p">,</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">the</span> <span class="n">gene</span> <span class="n">start</span>
</pre></div>
</div>
<p>Write a function called <code class="docutils literal notranslate"><span class="pre">gene2exons</span></code> that reads the gene annotation from this file and converts it to a file with exon information. The function should accept two arguments, the <code class="docutils literal notranslate"><span class="pre">input_file</span></code> and the <code class="docutils literal notranslate"><span class="pre">output_file</span></code>. The output should be tab-separated and will contain 5 columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">chromosome</span>
<span class="mi">2</span> <span class="o">-</span> <span class="n">exon</span> <span class="n">start</span>
<span class="mi">3</span> <span class="o">-</span> <span class="n">exon</span> <span class="n">end</span>
<span class="mi">4</span> <span class="o">-</span> <span class="n">exon</span> <span class="n">name</span><span class="p">:</span> <span class="n">gene</span> <span class="n">name</span> <span class="n">followed</span> <span class="n">by</span> <span class="n">a</span> <span class="o">.</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">exon</span> <span class="n">number</span>
<span class="mi">5</span> <span class="o">-</span> <span class="n">strand</span>
</pre></div>
</div>
<p>For instance, for the gene SALL4 the output should look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chr20</span> <span class="mi">51782330</span> <span class="mi">51784684</span> <span class="n">SALL4</span><span class="mf">.1</span> <span class="o">-</span>
<span class="n">chr20</span> <span class="mi">51788860</span> <span class="mi">51789141</span> <span class="n">SALL4</span><span class="mf">.2</span> <span class="o">-</span>
<span class="n">chr20</span> <span class="mi">51790021</span> <span class="mi">51792352</span> <span class="n">SALL4</span><span class="mf">.3</span> <span class="o">-</span>
<span class="n">chr20</span> <span class="mi">51802278</span> <span class="mi">51802520</span> <span class="n">SALL4</span><span class="mf">.4</span> <span class="o">-</span>
</pre></div>
</div>
<p>The gene SALL4 has four exons, which are numbered from 1 to 4. Exon numbers are not dependent on the
strand, they are numbered from low start position to high start position.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="extra_exercises.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">7. </span>Assembling the pieces</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="scripts.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9. </span>Scripts</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Simon van Heeringen, Arjen Brinkman, Kees Albers<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>